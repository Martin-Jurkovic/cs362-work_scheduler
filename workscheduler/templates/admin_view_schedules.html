<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Schedules - Work Scheduler</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <!-- Navigation Bar -->
    {% include 'navbar.html' %}
    <!-- Main Content -->
    <div class="content-container">
        <h1>Schedules for {{ current_week }}</h1>
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="flash-message {{ category }}">{{ message }}</div>
            {% endfor %}
          {% endif %}
        {% endwith %}
    <!-- Generate Schedules Button -->
    <form method="POST" class="generate-schedule-form">
        <div class="form-group">
            <label for="shifts_per_day" class="schedule-label">Shifts Per Day:</label>
            <input type="number" class="schedule-input" id="shifts_per_day" 
                   name="shifts_per_day" value="1" min="1" max="3">
        </div>
        <div class="form-group">
            <label for="max_shifts" class="schedule-label">Max Shifts Per Employee:</label>
            <input type="number" class="schedule-input" id="max_shifts" 
                   name="max_shifts" value="5" min="1" max="7">
        </div>
        <button type="submit" name="action" value="generate" 
                class="schedule-btn">Generate Schedules</button>
    </form>

        <!-- Schedules Table -->
        <div class="schedule-table">
            <table>
                <thead>
                    <tr>
                        <th>Employee</th>
                        {% for date in week_dates %}
                        <th>{{ date.strftime('%a<br>%b %d')|safe }}</th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% for username, schedule in schedules.items() %}
                    <tr>
                        <td>{{ username }}</td>
                        {% for date in week_dates %}
                        {% set date_str = date.strftime('%Y-%m-%d') %}
                        <td>
                            {% if date_str in schedule %}
                                {% set shift = schedule[date_str] %}
                                {{ shift.start_time|datetimeformat }} - {{ shift.end_time|datetimeformat }}
                            {% else %}
                                Off
                            {% endif %}
                        </td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>
